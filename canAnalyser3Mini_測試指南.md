# canAnalyser3Mini 測試指南

## 📋 **測試設定**

### **硬體連接**
1. canAnalyser3Mini → XMC4800
   - CAN_H ↔ CAN_H
   - CAN_L ↔ CAN_L  
   - GND ↔ GND
2. 確認 120Ω 終端電阻已連接

### **canAnalyser3Mini 軟體設定**
1. **波特率**: 250 kbps
2. **模式**: Normal (非 Listen Only)
3. **過濾器**: 停用 (接收所有訊息)

## 🚀 **測試序列**

### **測試 1: 基本 CAN 通訊**
```
發送設定:
ID: 0x60A (十進位: 1546)
DLC: 8
Data: 40 00 10 00 00 00 00 00
格式: Standard (11-bit)
類型: Data Frame
```

**期望結果**:
- XMC4800 UART 輸出: `🎯 真正的 CAN0_3 中斷被觸發！`
- 接收處理: `✅ 調用 CANopen 中斷處理`

### **測試 2: CANopen SDO 讀取請求**
```
發送設定:
ID: 0x60A
DLC: 8  
Data: 40 00 10 00 00 00 00 00
說明: 讀取物件字典 0x1000 (設備類型)
```

**期望結果**:
- 接收中斷觸發
- XMC4800 回應: ID=0x58A (SDO Response)

### **測試 3: 連續測試**
```
每秒發送一次:
ID: 0x60A
Data: 40 00 10 01 00 00 00 00  ← 變更 byte 3
```

**期望結果**:
- 每次都觸發中斷
- 計數器遞增顯示

## 🔍 **診斷檢查**

### **檢查 1: UART 輸出**
正常輸出應該包含:
```
🎯 真正的 CAN0_3 中斷被觸發！
✅ 調用 CANopen 中斷處理  
🎯 CAN0_3 中斷處理完成
*** MULTICAN_CONFIG 接收成功 ***
ID=0x60A, DLC=8
Data: 40 00 10 00 00 00 00 00
```

### **檢查 2: canAnalyser3Mini 接收**
應該看到 XMC4800 的回應:
```
TX: ID=0x58A (SDO Response)
或
TX: ID=0x08A (Emergency)  
或
TX: ID=0x70A (Heartbeat)
```

### **檢查 3: 無中斷情況**
如果只看到:
```
🚨 幽靈數據過濾: ID=0x60A, 跳過處理
```
表示數據是自回收，不是真實的 canAnalyser3Mini 發送。

## ⚡ **問題排除**

### **問題: 無任何 UART 輸出**
1. 檢查 UART 連接 (115200 baud)
2. 檢查電源供應
3. 重新燒錄韌體

### **問題: 無中斷觸發**
1. 檢查 CAN 波特率匹配 (250 kbps)
2. 檢查 CAN 硬體連接
3. 檢查終端電阻

### **問題: 收到但被過濾**
1. 檢查測試數據格式
2. 確認非全零數據
3. 檢查 ID 正確性 (0x60A)

## 📊 **成功標準**

✅ **完全成功**: 
- CAN0_3 中斷觸發
- 正確數據接收
- CANopen 處理正常
- XMC4800 正確回應

⚠️ **部分成功**:
- 中斷觸發但數據錯誤
- 接收但無回應

❌ **失敗**:
- 無中斷觸發
- 只有幽靈數據過濾訊息